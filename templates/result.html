<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>검색 결과</title>
</head>
<body>
    <h1>검색 결과</h1>
    <table border="1">
        <thead>
            <tr>
                <th>상품명</th>
                <th>가격</th>
                <th>브랜드</th>
                <th>카테고리</th>
                <th>링크</th>
            </tr>
        </thead>
        <tbody>
            {% for item in results %}
            <tr>
                <td>{{ item.title }}</td>
                <td>{{ item.lprice }}</td>
                <td>{{ item.brand }}</td>
                <td>{{ item.category }}</td>
                <td><a href="{{ item.link }}" target="_blank">보기</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>
    <button><a href="{{ url_for('download', keyword=results[0].title) }}">엑셀 파일 다운로드</a></button>
    <input type="email" id="userEmail" placeholder="이메일 입력">
    <button id="sendMailBtn">메일 보내기</button>
    <button><a href="/slack"></a>slack 보내기</button>
    <br><br>
    <button><a href="/">다시 검색하기</a></button>
</body>
</html>

<script>
    document.getElementById('sendMailBtn').addEventListener('click', function() {
        const email = document.getElementById('userEmail').value;
    
        fetch('/mail', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ recv_email: email })
        })
        .then(response => {
            if (response.ok) {
                alert('메일이 성공적으로 전송되었습니다!');
            } else {
                alert('메일 전송 실패 😢');
            }
        })
        .catch(error => {
            console.error('에러:', error);
            alert('에러 발생!');
        });
    });
</script>
    