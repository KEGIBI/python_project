<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²€ìƒ‰ ê²°ê³¼</title>
</head>
<body>
    <h1>ê²€ìƒ‰ ê²°ê³¼</h1>
    <table border="1">
        <thead>
            <tr>
                <th>ìƒí’ˆëª…</th>
                <th>ê°€ê²©</th>
                <th>ë¸Œëœë“œ</th>
                <th>ì¹´í…Œê³ ë¦¬</th>
                <th>ë§í¬</th>
            </tr>
        </thead>
        <tbody>
            {% for item in results %}
            <tr>
                <td>{{ item.title }}</td>
                <td>{{ item.lprice }}</td>
                <td>{{ item.brand }}</td>
                <td>{{ item.category }}</td>
                <td><a href="{{ item.link }}" target="_blank">ë³´ê¸°</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>
    <button><a href="{{ url_for('download', keyword=results[0].title) }}">ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a></button>
    <input type="email" id="userEmail" placeholder="ì´ë©”ì¼ ì…ë ¥">
    <button id="sendMailBtn">ë©”ì¼ ë³´ë‚´ê¸°</button>
    <button><a href="/slack"></a>slack ë³´ë‚´ê¸°</button>
    <br><br>
    <button><a href="/">ë‹¤ì‹œ ê²€ìƒ‰í•˜ê¸°</a></button>
</body>
</html>

<script>
    document.getElementById('sendMailBtn').addEventListener('click', function() {
        const email = document.getElementById('userEmail').value;
    
        fetch('/mail', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ recv_email: email })
        })
        .then(response => {
            if (response.ok) {
                alert('ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else {
                alert('ë©”ì¼ ì „ì†¡ ì‹¤íŒ¨ ğŸ˜¢');
            }
        })
        .catch(error => {
            console.error('ì—ëŸ¬:', error);
            alert('ì—ëŸ¬ ë°œìƒ!');
        });
    });
</script>
    